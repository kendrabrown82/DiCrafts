<html lang="en">
<head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script type="text/javascript">
        // confirm document is ready
        $(document).ready(function () {
            console.log("ready!");
        
        var movieList = document.getElementById('movieList');
        var movieBody = document.getElementById('movieBody');
        var mButton = document.getElementById("getMultItems"); 
        var sButton = document.getElementById('getOneItem');
        var submitButton = document.getElementById('submitButton')


        // Button to retrieve multiple items
        mButton.addEventListener('click', function() {
            var apiKey = 'b829fc58';
            $.get(`https://www.omdbapi.com/?apikey=${apiKey}&type=movie&s=legend`, function (data) {
                addMultiple(data);
            });
        });

        // Button to retrieve single item
        sButton.addEventListener('click', function() {
            var apiKey = 'b829fc58';
            $.get(`https://www.omdbapi.com/?apikey=${apiKey}&type=movie&s=batman`, function (data) {
                addSingle(data);
            });
        });


        // Search for items
        submitButton.addEventListener('click', function() {
            var movieSelection = document.getElementById('movieSelection').value;
            var apiKey = 'b829fc58';
            $.get(`https://www.omdbapi.com/?apikey=${apiKey}&type=movie&s=${movieSelection}`, function (data) {
                addMultiple(data);
            });
        });

        //---------------- FUNCTIONS ------------------------//

        // function to get multiple items
        function addMultiple(data) {
            // clear the existing item in the div before adding items
            movieBody.innerHTML = '';
            for (var i = 0; i < data.Search.length; i++) { 
                var title = data.Search[i].Title;
                var year = data.Search[i].Year;
                var imdbID = data.Search[i].imdbID;
                var type = data.Search[i].Type;
                var poster = data.Search[i].Poster;
                
                var movieContainer = document.createElement('div');
                // using template literal to append items
                var movieInfo = 
                `<div class="movies">
                    <p>Title: ${title}, Year: ${year}, IMDB ID: ${imdbID}, Type: ${type}</p>
                    <img class="posters" src="${poster}">
                </div>
                
                `
                movieContainer.innerHTML = movieInfo;
                console.log(movieInfo);
                movieBody.appendChild(movieContainer);
            }
        }      



        // function to get a single item
        function addSingle(data) {
            //Get random movie from array of searched items
            var singleMovie = data.Search[Math.floor(Math.random() * data.Search.length)];      
            var title = singleMovie.Title;
            var year = singleMovie.Year;
            var imdbID = singleMovie.imdbID;
            var type = singleMovie.Type;
            var poster = singleMovie.Poster;
            // clear the existing item in the div before adding items
            movieBody.innerHTML = '';
            var movieContainer = document.createElement('div');
            // using template literal to append items
            var movieInfo = 
            `<div class="movies">
                <p>Title: ${title}, Year: ${year}, IMDB ID: ${imdbID}</p>
                <img class="posters" src="${poster}">
            </div>
            
            `
            movieContainer.innerHTML = movieInfo;
            console.log(movieInfo);
            movieBody.appendChild(movieContainer);
            
        }      
        
    }); // <--- end of document readiness check
    </script>

    <title>Document</title>
</head>
<body>
    <button class="btn btn-success" id="getMultItems">Get List</button>
    
    <button class="btn btn-success" id="getOneItem">Get One</button>
    
    <div>
        <div class="form-group">
            <!-- <label for="movieSelection">Select Movie</label> -->
            <input type="text" class="form-control" id="movieSelection" aria-describedby="" placeholder="Enter movie choice">
        </div>
        <button type="submit" class="btn btn-primary" id="submitButton">Submit</button>   
    </div>

    <div id="movieBody"></div>
    
</body>
</html>